import * as THREE from "three";import { XRButton } from "three/examples/jsm/Addons.js";import { OculusHandModel } from "three/examples/jsm/webxr/OculusHandModel.js";import * as CANNON from 'https://cdn.jsdelivr.net/npm/cannon-es@0.18.0/dist/cannon-es.js';class LeverPlayground {    constructor() {        this.scene = null;        this.camera = null;        this.renderer = null;        this.controls = null;        // Lever components        this.lever = null;        this.fulcrum = null;        this.fulcrumPosition = 0;        this.leverBeam = null;        // Physics        this.objects = [];        this.gravityEnabled = true;        this.dampingFactor = 0.95;        this.leverRotation = 0;        this.leverAngularVelocity = 0;        // Interaction        this.raycaster = new THREE.Raycaster();        this.mouse = new THREE.Vector2();        this.draggedObject = null;        this.isDragging = false;        // Dashboard elements        this.dashboard = new THREE.Group();        this.init();    }    init() {        // Scene setup        this.scene = new THREE.Scene();        // Camera setup (adjust position for XR visibility)        this.camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);        this.camera.position.set(0, 8, 15);        this.camera.lookAt(0, 0, 0);        // Renderer setup        this.renderer = new THREE.WebGLRenderer({ antialias: true });        this.renderer.setSize(window.innerWidth, window.innerHeight);        this.renderer.shadowMap.enabled = true;        this.renderer.shadowMap.type = THREE.PCFSoftShadowMap;        document.body.appendChild(this.renderer.domElement);        // Lighting setup        const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);        this.scene.add(ambientLight);        const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);        directionalLight.position.set(10, 20, 10);        directionalLight.castShadow = true;        this.scene.add(directionalLight);        // Create lever system        this.createLeverSystem();        // Set up XR button        this.setupXR();    }    createLeverSystem() {        // Example lever and fulcrum setup (you can customize this part)        const fulcrumGeometry = new THREE.ConeGeometry(0.8, 2, 3);        const fulcrumMaterial = new THREE.MeshStandardMaterial({ color: 0x8b4513, roughness: 0.7, metalness: 0.3 });        this.fulcrum = new THREE.Mesh(fulcrumGeometry, fulcrumMaterial);        this.fulcrum.rotation.z = Math.PI;        this.fulcrum.position.set(this.fulcrumPosition, -1, 0);        this.fulcrum.castShadow = true;        this.scene.add(this.fulcrum);        const beamGeometry = new THREE.BoxGeometry(12, 0.3, 1);        const beamMaterial = new THREE.MeshStandardMaterial({ color: 0xcd853f, roughness: 0.6, metalness: 0.4 });        const beam = new THREE.Mesh(beamGeometry, beamMaterial);        beam.castShadow = true;        beam.receiveShadow = true;        this.leverBeam = new THREE.Group();        this.leverBeam.add(beam);        this.leverBeam.position.set(this.fulcrumPosition, 0, 0);        this.scene.add(this.leverBeam);    }    setupXR() {        document.body.appendChild(XRButton.createButton(this.renderer, {            'requiredFeatures': ['hand-tracking'],            'optionalFeatures': ['depth-sensing'],            'depthSensing': { 'usagePreference': ['gpu-optimized'], 'dataFormatPreference': [] }        }));        this.renderer.xr.enabled = true;        this.renderer.setAnimationLoop(this.animate.bind(this));        this.addXRControls();        this.addControlPanel();  // Adding the control panel    }    addXRControls() {        // Your existing XR controls code (hands, controllers, etc.)    }    addControlPanel() {        // Add buttons for object sizes (Small, Medium, Large, Huge)        this.addButton(0x00ff00, 'Small (2kg)', -10, 5, 0, 2);  // Green button        this.addButton(0x0000ff, 'Medium (5kg)', -5, 5, 0, 5);  // Blue button        this.addButton(0xff0000, 'Large (10kg)', 0, 5, 0, 10);  // Red button        this.addButton(0xffff00, 'Huge (20kg)', 5, 5, 0, 20);   // Yellow button        // Add the Fulcrum Position Slider        this.createSlider();        // Add Gravity Toggle Button        this.createGravityToggle();        // Add Reset Button        this.createResetButton();    }    addButton(color, label, x, y, z, size) {        const geometry = new THREE.PlaneGeometry(3, 1);        const material = new THREE.MeshStandardMaterial({ color });        const button = new THREE.Mesh(geometry, material);        button.position.set(x, y, z);        button.userData = { label, size };        this.scene.add(button);        // Add interaction for the button        button.onClick = () => {            console.log(`${button.userData.label} clicked`);            this.addObject(button.userData.size);        };    }    createSlider() {        const sliderMaterial = new THREE.MeshStandardMaterial({ color: 0xaaaaaa });        const sliderGeometry = new THREE.BoxGeometry(10, 0.1, 1);        const slider = new THREE.Mesh(sliderGeometry, sliderMaterial);        slider.position.set(0, 6, 0);        this.scene.add(slider);        const sliderHandle = new THREE.Mesh(new THREE.CylinderGeometry(0.2, 0.2, 1), new THREE.MeshStandardMaterial({ color: 0x888888 }));        sliderHandle.position.set(0, 6, 0);        this.scene.add(sliderHandle);    }    createGravityToggle() {        const toggleButtonMaterial = new THREE.MeshStandardMaterial({ color: 0x00ff00 });        const toggleButtonGeometry = new THREE.BoxGeometry(3, 1, 1);        const toggleButton = new THREE.Mesh(toggleButtonGeometry, toggleButtonMaterial);        toggleButton.position.set(0, 5, 10);        toggleButton.userData = { label: 'Gravity ON' };        this.scene.add(toggleButton);        toggleButton.onClick = () => {            this.gravityEnabled = !this.gravityEnabled;            toggleButton.userData.label = this.gravityEnabled ? 'Gravity ON' : 'Gravity OFF';            toggleButton.material.color.set(this.gravityEnabled ? 0x00ff00 : 0xff0000);        };    }    createResetButton() {        const resetButtonMaterial = new THREE.MeshStandardMaterial({ color: 0xeeee00 });        const resetButtonGeometry = new THREE.BoxGeometry(4, 1, 1);        const resetButton = new THHREE.Mesh(resetButtonGeometry, resetButtonMaterial);        resetButton.position.set(0, 5, 12);        resetButton.userData = { label: 'Reset Playground' };        this.scene.add(resetButton);        resetButton.onClick = () => {            console.log('Resetting the playground...');            this.resetScene();        };    }    addObject(size) {        console.log(`Object of size ${size} added`);        // Implement the logic to add objects to the scene, e.g., different mass based on the size    }    resetScene() {        console.log('Scene reset');        // Implement the logic to reset the lever, objects, and physics    }    animate() {        const deltaTime = 0.016;  // ~60fps        this.updatePhysics(deltaTime);        this.renderer.render(this.scene, this.camera);    }    updatePhysics(deltaTime) {        if (this.gravityEnabled) {            // Apply gravity physics (update lever system, etc.)        }    }}// Initialize the applicationconst app = new LeverPlayground();